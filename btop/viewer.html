<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>btop</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@5.3.0/css/xterm.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { 
            background: #000; 
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        #terminal {
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        .xterm-viewport::-webkit-scrollbar { display: none; }
        .xterm-viewport { scrollbar-width: none; }
        /* Hide all cursor elements */
        .xterm-cursor-layer,
        .xterm-cursor,
        .xterm-cursor-block,
        .xterm-cursor-outline,
        .xterm-cursor-bar,
        .xterm-cursor-underline { 
            display: none !important; 
            visibility: hidden !important;
            opacity: 0 !important;
        }
        /* Disable text selection */
        .xterm-screen {
            user-select: none !important;
            -webkit-user-select: none !important;
        }
    </style>
</head>
<body>
    <div id="terminal"></div>
    
    <script src="https://cdn.jsdelivr.net/npm/xterm@5.3.0/lib/xterm.min.js"></script>
    <script>
        const term = new Terminal({
            cols: 100,
            rows: 45,
            cursorBlink: false,
            cursorStyle: 'bar',
            cursorInactiveStyle: 'none',
            cursorWidth: 0,
            disableStdin: true,
            convertEol: true,
            scrollback: 0,
            fontFamily: 'monospace',
            fontSize: 14,
            theme: {
                background: '#000000',
                foreground: '#c9a0f0',
                cursor: 'transparent',
                cursorAccent: 'transparent'
            }
        });
        
        term.open(document.getElementById('terminal'));
        
        // Hide cursor via escape code
        term.write('\x1b[?25l');
        
        const eventSource = new EventSource('/stream');
        
        eventSource.onmessage = (event) => {
            try {
                const data = JSON.parse(event.data);
                const content = data.ansi.replace(/\n$/, '');
                term.write('\x1b[?25l\x1b[H\x1b[J' + content + '\x1b[?25l');
            } catch (e) {
                console.error('Parse error:', e);
            }
        };
        
        eventSource.onerror = () => {
            term.write('\x1b[H\x1b[31mConnection lost...\x1b[0m');
        };
    </script>
</body>
</html>
